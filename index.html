<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ì§€êµ¬ëŠ” ë‚´ ê±°ì•¼!</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      margin: 0;
      background-image: url('background.png');
      background-size: cover;            /* í™”ë©´ì„ ê½‰ ì±„ì›€ */
      background-position: center;       /* ê°€ìš´ë° ì •ë ¬ */
      background-repeat: no-repeat;      /* ë°˜ë³µí•˜ì§€ ì•ŠìŒ */
      background-attachment: fixed;      /* ìŠ¤í¬ë¡¤í•´ë„ ê³ ì •ëœ ë°°ê²½ (ì„ íƒ) */
      margin: 0;
  padding: 0;
  height: 100%;
  overflow: auto;
}
    #startScreen {
      padding: 20px;
    }
  
#gameContainer {
  display: flex;
  flex-direction: column;
  align-items: center;
  height: 100%;
  overflow-y: auto; /* ì ìˆ˜íŒë§Œ ìŠ¤í¬ë¡¤ë¨ */
}

#mainArea {
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 100%;
  height: 100vh; /* ì „ì²´ í™”ë©´ ë†’ì´ */
  box-sizing: border-box;
  overflow: hidden;
}

#grid {
  display: grid;
  grid-template-columns: repeat(10, 1fr);
  grid-template-rows: repeat(10, 1fr);
  gap: 2px;
  width: 100vw;
  height: 90vh; /* í™”ë©´ì˜ 90%ë§Œ ì‚¬ìš©í•´ì„œ ê²©ìíŒ í‘œì‹œ */
  box-sizing: border-box;
}

.cell {
  background: #eee;
  border: 1px solid #999;
  font-size: 1.8vmin;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 4px;
  word-break: break-word;
  text-align: center;
  box-sizing: border-box;
  height: 100%;   /* ê° ì…€ì˜ ë†’ì´ëŠ” ìë™ìœ¼ë¡œ ê²°ì •ë¨ */
  width: 100%;
}

#showAnswerBtn {
    background-color: #b8b8b8;
    color: black;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    position: absolute;
    bottom: 0px;     /* ì•„ë˜ìª½ ì—¬ë°± */
    right: 10px;      /* ì˜¤ë¥¸ìª½ ì—¬ë°± */
    font-size: 14px;  /* ê¸€ì í¬ê¸° ì‘ê²Œ */
    padding: 5px 10px; /* ë²„íŠ¼ í¬ê¸° ì¤„ì„ */
}

#showAnswerBtn:hover {
    background-color: #84b2d3;
}

#resourceBox {
    font-size: 36px;        /* ê¸€ì í¬ê¸° í‚¤ì›€ */
    margin:0;         /* ìœ„ì•„ë˜ ì—¬ë°± ì¤„ì„ */
    padding: 6px;
    text-align: left;       /* ì™¼ìª½ ì •ë ¬ */
}

#resourceBox a {
    font-size: 48px;        /* ë§í¬ ê¸€ì í¬ê¸°ë„ ë™ì¼í•˜ê²Œ í‚¤ì›€ */
    color: #1a73e8;         /* ë§í¬ ìƒ‰ìƒ */
    text-decoration: underline;
}

#scorePanel {
  flex-shrink: 0;
  width: 100%;
  display: flex !important;
  flex-direction: column;
  overflow-x: auto;
  padding: 20px;
  box-sizing: border-box;
  background-color: white; /* ë°°ê²½ í°ìƒ‰ */
  border-radius: 8px;
  text-align: center;
  user-select: none;
  border-top: 4px solid #999;
  border-bottom: 4px solid #999;
  z-index: 10;
  font-size: 18px;
}

#scoreTable {
  width: 100%;
  border-collapse: collapse;
  margin: 0 auto;
}

#scoreTable th, #scoreTable td {
  border: 2px solid #999;
  padding: 14px;
  text-align: center;
  font-weight: bold;
  min-width: 100px;
  font-size: 20px;
  background-color: white;
}

.colorBox {
  display: inline-block;
  width: 20px;
  height: 20px;
  border-radius: 4px;
  margin-right: 6px;
  vertical-align: middle;
}

#endGameButton {
      display: block;
      width: 100%;
      padding: 10px 0;
      font-size: 18px;
      font-weight: bold;
      border: none;
      border-radius: 6px;
      background-color: #dc3545;
      color: white;
      cursor: pointer;
      transition: background-color 0.3s;
      user-select: none;
    }

#endGameButton:hover {
      background-color: #a71d2a;
    }

    .popup, .difficulty-popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #fefefe;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      padding: 24px;
      z-index: 100;
      width: 400px;
      text-align: center;
      display: none;
    }
    .difficulty-popup p {
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 20px;
    }
    .difficulty-popup button {
      margin: 8px;
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    .difficulty-popup button:nth-child(2) {
      background-color: #28a745;
      color: white;
    }
    .difficulty-popup button:nth-child(2):hover {
      background-color: #1e7e34;
    }
    .difficulty-popup button:nth-child(3) {
      background-color: #007bff;
      color: white;
    }
    .difficulty-popup button:nth-child(3):hover {
      background-color: #0056b3;
    }
    .difficulty-popup button:nth-child(4) {
      background-color: #dc3545;
      color: white;
    }
    .difficulty-popup button:nth-child(4):hover {
      background-color: #a71d2a;
    }
    .popup button, .difficulty-popup button {
      margin: 5px;
      padding: 8px 15px;
      font-size: 16px;
      cursor: pointer;
    }

#specialText {
      margin-top: 10px;
      font-weight: bold;
      color: #d9534f;
    }

    /* ì¡° ì´ë¦„ ì…ë ¥ì¹¸ ë””ìì¸ ë° ìˆ¨ê¹€ (ì²˜ìŒì—” ìˆ¨ê¹€) */
    #nameInputs {
      display: none;
      margin-top: 360px;
    }
    .playerName {
      font-size: 24px;
      padding: 12px 20px;
      border-radius: 20px;
      border: 2px solid #ccc;
      width: 300px;
      margin: 5px auto;
      display: block;
      box-sizing: border-box;
      text-align: center;
    }

    /* ì‹œì‘ ë²„íŠ¼ ë””ìì¸ (ê°€ìš´ë° ì •ë ¬) */
    #startButton {
      font-size: 32px;
      padding: 15px 40px;
      border-radius: 10px;
      border: none;
      cursor: pointer;
      background-color: #fffafa;
      color: black;
      font-weight: bold;
      transition: background-color 0.3s;
      user-select: none;
      margin-top: 440px;
    }
    #startButton:hover {
      background-color: #7b071f;
    }
    @keyframes explode {
  0% {
    transform: scale(0.5);
    opacity: 0;
    text-shadow: 0 0 10px red;
  }
  50% {
    transform: scale(2.5);
    opacity: 1;
    text-shadow: 0 0 40px orange, 0 0 80px yellow;
  }
  100% {
    transform: scale(1);
    opacity: 0;
    text-shadow: none;
  }
}

#questionPopup {
  display: relative;             /* í”Œë ‰ìŠ¤ë¡œ ì„¸ë¡œ ì •ë ¬ */
  flex-direction: column;    /* ì„¸ë¡œ ë°©í–¥ */
  margin: 0;                 /* ë°”ê¹¥ ì—¬ë°± ì œê±° */
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: white;
  padding: 5px;
  border: 2px solid black;
  border-radius: 12px;
  width: 1000px;
  height: 500px;
  max-height: 80vh;
  overflow-y: auto;  /* ìŠ¤í¬ë¡¤  */
  font-size: 2.5vmin;     /* í™”ë©´ í¬ê¸°ì— ë”°ë¼ ê¸€ì ìë™ ì¡°ì ˆ */
  z-index: 1000;
  box-shadow: 0 0 20px rgba(0,0,0,0.3);
  overflow-y: auto;
  gap: 4px;
}

.material-box {
  border: 1px solid #999;
  padding: 10px;
  margin: 10px 0;
  background: #f9f9f9;
  white-space: pre-line;   /* ì¤„ë°”ê¿ˆ(\n) í‘œì‹œ */
}

.source {
  text-align: right;
  font-size: 0.9em;
  color: #555;
}

.fullscreen-answer {
    display: none;
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.85);
    color: #ff0000;
    font-size: 6em;
    font-weight: bold;
    justify-content: center;
    align-items: center;
    text-align: center;
    z-index: 9999;
    display: flex; /* flexë¡œ ì¤‘ì•™ ì •ë ¬ */
    flex-direction: column;
}

.answer-box {
  margin-top: 20px;
  font-size: 2em;
  font-weight: bold;
  color: red;
  text-align: center;
}

#choicesContainer {
  margin: 4px 0;       /* ìœ„ì•„ë˜ ì—¬ë°± ì œê±° */
  padding: 5px;    /* ì¡°ê¸ˆë§Œ ì•ˆìª½ ì—¬ë°± */
  width: 90%;      /* í­ ì¡°ì • */
  box-sizing: border-box; /* íŒ¨ë”© í¬í•¨ í­ ê³„ì‚° */
  display: flex;
  flex-direction: column; /* ì„¸ë¡œ ì •ë ¬ */
}

#choicesContainer button {
  font-size: 16px;   /* ë³´ê¸° ê¸€ì í¬ê¸° í‚¤ì›€ */
  padding: 5px 10px;      /* ë³´ê¸° ë²„íŠ¼ í¬ê¸° í‚¤ì›€ */
  border-radius: 10px;
  border: 2px solid #333;
  cursor: pointer;
}

#questionText {
  font-size: 30px;   /* â† ë¬¸ì œ ê¸€ì”¨ í¬ê²Œ */
  font-weight: bold;
  margin: 0;       /* ìœ„ì•„ë˜ ì—¬ë°± ì œê±° */
  padding: 0;      /* íŒ¨ë”© ì œê±° */
  text-align: center;
  white-space: pre-line;   /* ì¤„ë°”ê¿ˆ(\n) í‘œì‹œ */
}

#explosionEffect {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 100px;
  color: #ff4444;
  z-index: 9999;
  display: none;
  pointer-events: none;
  animation: explode 1s ease-out;
}
  </style>
</head>
<body>
  <div id="startScreen">
    <!-- ì‹œì‘ ë²„íŠ¼ë§Œ ë¨¼ì € ë³´ì„ -->
    <button id="startButton">ì‹œì‘</button>
    
    <!-- ì¡° ì´ë¦„ ì…ë ¥ì¹¸ (ì²˜ìŒì—” ìˆ¨ê¹€) -->
    <div id="nameInputs">
      <input type="text" placeholder="1ì¡°" class="playerName" />
      <input type="text" placeholder="2ì¡°" class="playerName" />
      <input type="text" placeholder="3ì¡°" class="playerName" />
      <input type="text" placeholder="4ì¡°" class="playerName" />
    </div>
  </div>

  <div id="gameContainer">
    <div id="mainArea">
      <div id="turnDisplay"></div>
      <div id="grid"></div>
    </div>

    <table id="scoreTable">
  <thead>
    <tr id="scoreHeaderRow"><th>ì¡° ì´ë¦„</th></tr>
  </thead>
  <tbody>
    <tr id="scoreDataRow"><th>ì ìˆ˜</th></tr>
  </tbody>
</table>
      <button id="endGameButton" onclick="endGame()">ê²Œì„ ì¢…ë£Œ</button>
    </div>
  </div>
  <div id="scorePanel" style="margin-top: 20px;">
  </div>

  <div class="difficulty-popup" id="difficultyPopup">
    <p>ë‚œì´ë„ë¥¼ ì„ íƒí•˜ì„¸ìš”:</p>
    <button onclick="selectDifficulty('í•˜')">í•˜</button>
    <button onclick="selectDifficulty('ì¤‘')">ì¤‘</button>
    <button onclick="selectDifficulty('ìƒ')">ìƒ</button>
  </div>

  <div id="specialEventText"></div>
  <div id="resEl"></div>

<!-- ë¬¸ì œ íŒì—… -->
<div id="questionPopup" class="popup" style="display:none;">
  <button id="questionPopupClose" style="position:absolute; top:10px; right:10px;">âœ–</button>
  <div id="optionsContainer"></div> <!-- ë³´ê¸° ì¶œë ¥ ì˜ì—­ -->

  <div id="answerBox"></div>
  
  <div id="specialText" style="display:none;"></div>
  <div id="questionContent"></div>

  <!-- ë¬¸ì œ -->
  <div id="questionText" style="display:none; font-size:24px; font-weight:bold;"></div>

  <!-- ìë£Œ ë°•ìŠ¤ -->
  <div id="resourceBox" style="border: 2px solid #444; padding: 10px; margin: 10px 0; background:#f9f9f9; font: size 60px;">
    <p id="questionResource" style="font-size:18px; margin:0;"></p>
    <p id="questionSource" style="text-align:right; font-size:14px; margin:0; color:#666;"></p>
  </div>

  <!-- ë³´ê¸° (ìˆìœ¼ë©´ í‘œì‹œë¨) -->
  <div id="choicesContainer" style="display:flex; flex-direction:column; gap:8px; margin:10px 0;">
    <button id="choice1" onclick="answerMultipleChoice(0)"></button>
    <button id="choice2" onclick="answerMultipleChoice(1)"></button>
    <button id="choice3" onclick="answerMultipleChoice(2)"></button>
    <button id="choice4" onclick="answerMultipleChoice(3)"></button>
  </div>

  <!-- ì •ë‹µ/ì˜¤ë‹µ ë²„íŠ¼ -->
  <div style="margin-top:15px;">
    <button onclick="handleAnswer(true)" style="padding:10px 20px; font-size:18px;">ì •ë‹µ</button>
    <button onclick="handleAnswer(false)" style="padding:10px 20px; font-size:18px;">ì˜¤ë‹µ</button>
    <button id="showAnswerBtn" style="padding:10px 20px; font-size:18px;">ì •ë‹µ í™•ì¸</button>
</div>
  </div>

  <!-- ì •ë‹µ í‘œì‹œ ë°•ìŠ¤ -->
  <div id="answerDisplay" style="display:none;">
    <span id="correctAnswer"></span>
  </div>
</div>
</div>

<div id="fullscreenAnswer" style="
    display:none;
    position:fixed;
    top:0; left:0;
    width:100%; height:100%;
    background:rgba(0,0,0,0.7);
    color:white;
    font-size:3em;
    justify-content:center;
    align-items:center;
    text-align:center;
    z-index:9999;
">
</div>

  <div class="popup" id="rankingPopup">
    <h3>ê²Œì„ ê²°ê³¼</h3>
    <div id="rankingList" style="text-align: left; margin: 10px 0;"></div>
    <button onclick="closeRankingPopup()">ë‹«ê¸°</button>
  </div>

  <!-- ìŒì•… ì˜¤ë””ì˜¤ (íŒŒì¼ ê²½ë¡œ í™•ì¸ í•„ìš”) -->
  <audio id="bgm" src="the_motion.mp3"></audio>
  <audio id="startSound" src="start.mp3"></audio>
  <audio id="correctSound" src="correct.mp3" preload="auto"></audio><audio id="wrongSound" src="wrong.mp3" preload="auto"></audio>
  <audio id="specialSound" src="special.mp3" preload="auto"></audio>

  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <script>
    let questionsFromSheet = [];
    let currentQuestion;
    let selectedCity = "";
    let selectedDifficulty = null;
    let questionsLoaded = false;
    let usedHardQuestions = []; // ìƒ ë‚œì´ë„ ë¬¸ì œ ì‚¬ìš© ê¸°ë¡

async function loadQuestions() {
  if (questionsLoaded) return;
  return new Promise((resolve, reject) => {
   Papa.parse("earthq.csv", {
  download: true,
  header: true,
  quoteChar: '"',
  skipEmptyLines: true,
  complete: function(results) {
    questionsFromSheet = results.data.filter(q => q.question); // ë¹ˆ ë¬¸ì œ ì œì™¸
    console.log("CSV íŒŒì‹± ì™„ë£Œ, ì´ ë¬¸ì œ ìˆ˜:", questionsFromSheet.length);
    console.log("ì²« ë¬¸ì œ:", questionsFromSheet[0]);
    console.log(Object.keys(questionsFromSheet[0]));
            questionsLoaded = true;
    resolve();
      },
      error: function(err) {
        console.error("CSV ë¡œë”© ì‹¤íŒ¨:", err);
        reject(err);
    }});
  })
    console.log("ê²Œì„ ì‹œì‘ ì „ CSV ë°ì´í„°:", questionsFromSheet, "ì´ ê¸¸ì´:", questionsFromSheet.length);

    if (!questionsFromSheet || questionsFromSheet.length === 0) {
        alert("ë¬¸ì œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤!");
        return;
    }
     // ì„ íƒì§€ ë²„íŠ¼ ìƒì„±
  let choices = [currentQuestion.choice1, currentQuestion.choice2, currentQuestion.choice3, currentQuestion.choice4];
choices.forEach((choice, i) => {
    const btn = document.getElementById("choice" + (i + 1));
    if (choice) {
        btn.style.display = "inline-block";
        btn.innerText = choice;
    } else {
        btn.style.display = "none";
    }
});

if (specialCities[selectedCity]) {
   currentQuestion = { city: selectedCity, isSpecial: true };
   showQuestion(currentQuestion);
   return;
}

    // âœ… ì¼ë°˜ ë„ì‹œ â†’ ë¬¸ì œ ê²€ìƒ‰
    const question = questions.find(
        q => q.city === city && q.difficulty === difficulty
    );
};
      document.getElementById("startButton").addEventListener("click", () => {
      document.getElementById("startButton").style.display = "none";
      document.getElementById("nameInputs").style.display = "block";
  });

window.addEventListener("load", async () => {
    try {
        await loadQuestions();
        console.log("CSV íŒŒì‹± ì™„ë£Œ:", questionsFromSheet.length);

        if (!questionsFromSheet || questionsFromSheet.length === 0) {
            alert("ë¬¸ì œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤!");
            return;
        }

        // ì‹œì‘ ë²„íŠ¼ í™œì„±í™”
        const startBtn = document.getElementById("startButton");
        startBtn.disabled = false;

        startBtn.addEventListener("click", () => {
            startBtn.style.display = "none";
            document.getElementById("nameInputs").style.display = "block";
            // ì´ë¦„ ì…ë ¥ í›„ ê²Œì„ ì‹œì‘ ë²„íŠ¼ì—ì„œ showQuestion í˜¸ì¶œ
        });

    } catch (err) {
        console.error("CSV ë¡œë”© ì¤‘ ì˜¤ë¥˜:", err);
    }
});

    // ===== ê¸°ì¡´ ìŠ¤í¬ë¦½íŠ¸ ìœ ì§€ =====
    const players = [];
    const playerColors = ["red", "orange", "green", "blue"];
    let currentPlayer = 0;
    const usedQuestions = {}; // ì˜ˆ: { 'ê°œë´‰-í•˜': true }
    const cities = [
      "ì²­ì£¼", "íˆë¡œì‹œë§ˆ", "êµí† ", "ì´ìŠ¤íƒ„ë¶ˆ", "ë‰´ìš•", "ê°•í™”ë„", "ê´‘ì €ìš°", "ë‚˜ê°€ì‚¬í‚¤", "ìˆ˜ë§ˆíŠ¸ë¼", "ë¸Œë¤¼ì…€",
      "ê°œì„±", "ë‚™ì–‘", "ë‚˜ë¼", "ë¸í¬ì´", "ìš°í•œ", "ê²½ì£¼", "ë‚œì§•", "ë„ì¿„", "ëŸ°ë˜", "ì œì£¼ë„",
      "ê³µì£¼", "ì„±ë„", "ìì¹´ë¥´íƒ€", "ë¡œë§ˆ", "ê°œë´‰", "í•¨ì–‘", "ë² ì´ì§•", "ì¹´ë¼ì½”ë£¸", "ì•„ë¹„ë‡½", "ì² ì›",
      "ê¹€ì œ", "ë‹ˆìŠ¤", "í•˜ë…¸ì´", "ë¦¬ìš°ë°ìë„¤ì´ë£¨", "ë¹ˆ", "ê¹€í•´", "ì–‘ì €ìš°", "í†¨ë ˆë„", "ë©”ì¹´", "íŒŒë¦¬",
      "í¬ë¼ìŠ¤ë…¸ì•¼ë¥´ìŠ¤í¬", "ì˜íŒŒ", "ì½œì¹´íƒ€", "ë©¤í”¼ìŠ¤", "ë‚˜ì£¼", "ëŒ€êµ¬", "ì¥ì•ˆ", "ì•™ì½”ë¥´", "ë°”í‹°ì¹¸", "í•¨ë¶€ë¥´í¬",
      "ë‚¨ì–‘ì£¼", "í†ˆì§„", "ì¹´íŠ¸ë§Œë‘", "ë² ë„¤ì¹˜ì•„", "ë…¼ì‚°", "ì¶©ì¹­", "í‚¤ì´ìš°", "ë³´ìŠ¤í„´", "í˜ë¥´ì„¸í´ë¦¬ìŠ¤", "í•­ì €ìš°",
      "ì˜¤í‚¤ë‚˜ì™€", "ë‹¹ì§„", "ì‚¬ë¼ì˜ˆë³´", "ì„œìš¸", "ìƒíŠ¸í˜í…Œë¥´ë¶€ë¥´í¬", "ëŒ€ë§ˆë„", "ì•„ë°”ë‚˜", "ìƒì£¼", "ë² ë¥¼ë¦°", "ìš¸ì‚°",
      "ì•„í—¨", "ì›ì‚°", "ì•…ìˆ¨", "ì„œì²œ", "ì—ë“ ë²„ëŸ¬", "ì˜ì£¼", "ì˜ˆë£¨ì‚´ë ˜", "ì¸ì²œ", "ìš¸ë£¬ë””", "ì˜í¥",
      "ì›Œì‹±í„´ D.C.", "ì˜¤ì‚¬ì¹´", "ìŒë°˜ìì½©êµ¬", "ì§„ì£¼", "ì œë„¤ë°”", "ìº„ì°¨ì¹´ë°˜ë„", "ì¹´ë¥´íƒ€ê³ ", "ê³¡ì‚°", "ìº”ë²„ë¼", "ì˜ë ¹",
      "ìƒí•˜ì´", "ì²œì•ˆ", "ê°€ì˜¤", "í‰ì–‘", "ì¿ ìŠ¤ì½”", "ê´‘ì£¼", "í…Œë…¸ì¹˜í‹°í‹€ë€", "ë‰´ë¸ë¦¬", "ì˜¤ì‹œë¹„ì—¥ì¹¨", "ë¶€ì‚°"
    ];

    const specialCities = {
      "ìˆ˜ë§ˆíŠ¸ë¼": "ë¹„ìƒ! ëŒ€ì§€ì§„ ë°œìƒ!\nì„¸ê³„ì—ì„œ ê°€ì¥ ì¶”ìš´ ì „ìŸì€?",
      "ì˜¤í‚¤ë‚˜ì™€": "ë¹„ìƒ! ì§€ì§„ ë°œìƒ!\nì„¸ìƒì—ì„œ ê°€ì¥ ê°€ë‚œí•œ ì™•ì€?",
      "ìš°í•œ": "ë¹„ìƒ! ì½”ë¡œë‚˜-19 ì°½ê¶!\nì‹ í•˜ê°€ ì™•ì—ê²Œ ê³µì„ ë˜ì§€ë©´ì„œ í•˜ëŠ” ë§ì€?",
      "ìì¹´ë¥´íƒ€": "ë¹„ìƒ! í™ìˆ˜ ë°œìƒ!\nì¼ë³¸ ë±€ì´ í•œêµ­ ë±€ì„ ì´ê¸¸ ìˆ˜ ì—†ëŠ” ì´ìœ ëŠ”?",
      "íˆë¡œì‹œë§ˆ": "ë¹„ìƒ! í•˜ëŠ˜ì—ì„œ í•µí­íƒ„ì´ ë–¨ì–´ì¡Œë‹¤!\nì‹¸ì›€ì„ ì˜í•˜ëŠ” ì˜¤ë¦¬ëŠ”?",
      "ìº„ì°¨ì¹´ë°˜ë„": "ë¹„ìƒ! í™”ì‚° í­ë°œ!\në„Œì„¼ìŠ¤ ë¬¸ì œ!\nì¡°ì„ ì˜ ì™• ì¤‘ ê°€ì¥ ê³„ì‚°ì„ ì˜í•œ ì™•ì€?",
      "ì‚¬ë¼ì˜ˆë³´": "íƒ•!\në„Œì„¼ìŠ¤ ë¬¸ì œ!\nì¡°ì„ ì˜ ì™• ì¤‘ ê°€ì¥ ìˆ«ìë¥¼ ëª» ì„¸ëŠ” ì™•ì€?",
      "ì˜¤ì‹œë¹„ì—¥ì¹¨": "ì €ê¸°ì„œ êµ°ì¸ë“¤ì´!\nì‹ ì‚¬ê°€ í•˜ëŠ” ì¸ì‚¬ëŠ”?",
      "í¬ë¼ìŠ¤ë…¸ì•¼ë¥´ìŠ¤í¬": "ë¹„ìƒ! í‰êµ¬ìŠ¤ì¹´ ëŒ€í­ë°œ!\nì—¬ëª… í•™ìƒíšŒëŠ” ëª‡ ëŒ€ í•™ìƒíšŒì¸ê°€ìš”?",
      "í•¨ë¶€ë¥´í¬": "ë¹„ìƒ! ì½œë ˆë¼ ì°½ê¶!\nìš°ë¦¬ë‚˜ë¼ì—ì„œ ëŒ€í†µë ¹ì´ ëœ ì‚¬ëŒì€ ì´ ëª‡ ëª…ì¸ê°€ìš”?"
    };

    const startPositionsIndexes = [0, 9, 90, 99];
    const startPositions = startPositionsIndexes.map(i => cities[i]);

    const fixedQuestions = {
      í•˜: cities.reduce((acc, city, i) => {
        if(city) acc[city] = `${city} í•˜ ë‚œì´ë„ ë¬¸ì œ ì˜ˆì‹œ ${i + 1}`;
        return acc;
      }, {}),
      ì¤‘: cities.reduce((acc, city, i) => {
        if(city) acc[city] = `${city} ì¤‘ ë‚œì´ë„ ë¬¸ì œ ì˜ˆì‹œ ${i + 1}`;
        return acc;
      }, {})
    };

    const hardQuestions = [
      "ìƒ ë‚œì´ë„ ë¬¸ì œ ì˜ˆì‹œ 1",
      "ìƒ ë‚œì´ë„ ë¬¸ì œ ì˜ˆì‹œ 2",
      "ìƒ ë‚œì´ë„ ë¬¸ì œ ì˜ˆì‹œ 3",
      "ìƒ ë‚œì´ë„ ë¬¸ì œ ì˜ˆì‹œ 4",
      "ìƒ ë‚œì´ë„ ë¬¸ì œ ì˜ˆì‹œ 5"
    ];

   function openDifficultyPopup(city) {
  selectedCity = city;

  const difficultys= ["í•˜", "ì¤‘", "ìƒ"];
  difficultys.forEach((difficulty, index) => {
    const button = document.querySelector(`#difficultyPopup button:nth-child(${index + 2})`);
    const key = `${city}-${difficulty}`;
    if (usedQuestions[key]) {
      button.disabled = true;
      button.style.backgroundColor = "#ccc";
      button.style.cursor = "not-allowed";
      button.style.color = "#666";
    } else {
      button.disabled = false;

      // ì›ë˜ ìŠ¤íƒ€ì¼ ë³µì›
      if (difficulty === "í•˜") {
        button.style.backgroundColor = "#28a745"; // ê¸°ë³¸
        button.style.color = "white";
      } else if (difficulty === "ì¤‘") {
        button.style.backgroundColor = "#007bff";
        button.style.color = "white";
      } else if (difficulty === "ìƒ") {
        button.style.backgroundColor = "#dc3545";
        button.style.color = "white";
      }
      button.style.cursor = "pointer";
    }
  });

  document.getElementById("difficultyPopup").style.display = "block";
}

    function selectDifficulty(difficulty) {
  selectedDifficulty = difficulty;    // ë‚œì´ë„ ì €ì¥
  document.getElementById("difficultyPopup").style.display = "none";

    if (specialCities[selectedCity]) {
    currentQuestion = { city: selectedCity, isSpecial: true };
    showQuestion(currentQuestion);
    return; // ğŸ”¥ ì¼ë°˜ ë„ì‹œ ë¡œì§ íƒ€ì§€ ì•Šë„ë¡ return
  }

  const key = `${selectedCity}-${difficulty}`;
  if (usedQuestions[key]) {
    alert("ì´ë¯¸ í‘¼ ë¬¸ì œì…ë‹ˆë‹¤!");
    return;
  }
  usedQuestions[key] = true;  // ì‚¬ìš© ê¸°ë¡ ì €ì¥

  currentQuestion = "";

 if (difficulty === "ìƒ") {
    // ë„ì‹œ ì—†ì´ ìƒ ë‚œì´ë„ ë¬¸ì œë§Œ ëª¨ìœ¼ê¸°
    const hardQuestions = questionsFromSheet.filter(
      q => q.difficulty === "ìƒ"
    );

    if (hardQuestions.length > 0) {
      // ëœë¤ìœ¼ë¡œ í•˜ë‚˜ ë½‘ê¸°
      currentQuestion = hardQuestions[Math.floor(Math.random() * hardQuestions.length)];
    } else {
      alert("ìƒ ë‚œì´ë„ ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤!");
      return;
    }

  } else {
    // í•˜/ì¤‘ ë‚œì´ë„ëŠ” ë„ì‹œ+ë‚œì´ë„ ì¼ì¹˜í•´ì•¼ í•¨
    currentQuestion = questionsFromSheet.find(q => {
   return q.city?.trim() === selectedCity?.trim() &&
          q.difficulty?.trim() === difficulty?.trim();
});
  }

  if (!currentQuestion) {
    console.warn("í•´ë‹¹ ë„ì‹œ/ë‚œì´ë„ì˜ ë¬¸ì œ ì—†ìŒ:", { city: selectedCity, difficulty: difficulty });
    alert("ë¬¸ì œê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤!");
    return;
  }

  console.log("ì„ íƒëœ ë¬¸ì œ:", currentQuestion);
  showQuestion(currentQuestion);
}

console.log("ê²€ìƒ‰ ì§ì „:", selectedCity, selectedDifficulty);
console.log("ë°ì´í„° ìƒ˜í”Œ:", questionsFromSheet[0]);

function getRandomHardQuestion() {
    // ì „ì²´ ìƒ ë‚œì´ë„ ë¬¸ì œ ì¤‘ ì‚¬ìš©í•˜ì§€ ì•Šì€ ê²ƒë§Œ í•„í„°ë§
    const hardQuestions = questionsFromSheet.filter(q => currentQuestion.difficulty === "ìƒ");
  const unused = hardQuestions.filter(q => !usedHardQuestions.includes(currentQuestion.question));
    
    if (unusedHardQuestions.length === 0) {
        alert("ëª¨ë“  ìƒ ë‚œì´ë„ ë¬¸ì œê°€ ë‹¤ ì†Œì§„ë˜ì—ˆìŠµë‹ˆë‹¤!");
        return null; // ë” ì´ìƒ ë½‘ì„ ë¬¸ì œê°€ ì—†ìŒ
    }

     const rand = unused[Math.floor(Math.random() * unused.length)];
     usedHardQuestions.push(rand.question); // ì§ˆë¬¸ í…ìŠ¤íŠ¸ë¡œ ê¸°ë¡
     return rand;

    // ëœë¤ìœ¼ë¡œ ì„ íƒ
    const randomIndex = Math.floor(Math.random() * unusedHardQuestions.length);
    const question = unusedHardQuestions[randomIndex];

    // ì‚¬ìš© ê¸°ë¡ì— ì¶”ê°€
    usedHardQuestions.push(question.id);

    return question;
}

function resetQuestionUI() {
  // ì´ì „ ë¬¸ì œ ì •ë‹µ ìˆ¨ê¸°ê¸°
    const answerDisplay = document.getElementById("answerDisplay");
    if (answerDisplay) answerDisplay.style.display = "none";
    answerDisplay.textContent = "";
    
    document.getElementById("questionText").textContent = "";
    document.getElementById("questionText").style.display = "none";

    document.getElementById("resourceBox").style.display = "none";
    document.getElementById("questionResource").textContent = "";
    document.getElementById("questionSource").textContent = "";

    document.getElementById("choicesContainer").style.display = "none";

    document.getElementById("answerDisplay").style.display = "none";

    document.getElementById("specialText").textContent = "";
    document.getElementById("specialText").style.display = "none";

    document.getElementById("questionPopup").style.display = "none";
}

function selectCity(cityName) {
    resetQuestionUI();  // ê¸°ì¡´ ë¬¸ì œ/ìŠ¤í˜ì…œí…ìŠ¤íŠ¸ ì´ˆê¸°í™”

    selectedCity = cityName;

    if (specialCities[cityName]) {
        // ğŸ”¥ ìŠ¤í˜ì…œ ë„ì‹œ ë¡œì§
        const specialTextEl = document.getElementById("specialText");
        specialTextEl.textContent = specialCities[cityName];
        specialTextEl.style.display = "block";

        currentQuestion = { city: cityName, isSpecial: true };

        document.getElementById("questionPopup").style.display = "block";
        return;
    } else {
        // ğŸ”¥ ì¼ë°˜ ë„ì‹œ ë¡œì§
        const difficulty = selectedDifficulty || "í•˜"; // ë‚œì´ë„ ê¸°ë³¸ê°’
        const question = questionsFromSheet.find(q => 
            q.city?.trim() === cityName?.trim() && q.difficulty?.trim() === difficulty
        );

        if (!question) {
            alert("ë¬¸ì œê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤!");
            return;
        }

        currentQuestion = question;
        showQuestion(currentQuestion);
    }
}

function showQuestion(currentQuestion) {
    resetQuestionUI(); // ì—¬ê¸°ì„œë„ ì´ˆê¸°í™” ë°˜ë³µ

    if (currentQuestion.isSpecial) {
        const specialTextEl = document.getElementById("specialText");
        specialTextEl.textContent = specialCities[currentQuestion.city];
        specialTextEl.style.display = "block";
        document.getElementById("questionPopup").style.display = "block";
        return;
    }

    let questionText = (currentQuestion.question || "")
    .replace(/\r\n/g, "\n")      // ìœˆë„ìš° ì¤„ë°”ê¿ˆ í†µì¼
    .split("\n")                  // ì¤„ ë‹¨ìœ„ë¡œ ë¶„ë¦¬
    .map(line => line.trim())     // ê° ì¤„ ì•ë’¤ ê³µë°± ì œê±°
    .filter(line => line !== "")  // ë¹ˆ ì¤„ ì œê±°
    .join("\n");                  // ë‹¤ì‹œ í•©ì¹˜ê¸°

    // ì¼ë°˜ ë„ì‹œ ë¬¸ì œ UI
    document.getElementById("questionText").textContent = cleanQuestionText(currentQuestion.question);
    document.getElementById("questionText").style.display = "block";

    const resourceBox = document.getElementById("resourceBox");
    const hasResource = currentQuestion.resource && currentQuestion.resource.trim() !== "";
    const hasSource = currentQuestion.source && currentQuestion.source.trim() !== "";

    if (hasResource || hasSource) {
        resourceBox.style.display = "block";
        document.getElementById("questionResource").textContent = hasResource ? currentQuestion.resource : "";
        document.getElementById("questionSource").textContent = hasSource ? currentQuestion.source :"";
    } else {
        resourceBox.style.display = "none";
    }

    const choices = [currentQuestion.choice1, currentQuestion.choice2, currentQuestion.choice3, currentQuestion.choice4];
    const hasChoices = choices.some(c => c && c.trim() !== "");

    if (hasChoices) {
        const choicesContainer = document.getElementById("choicesContainer");
        choicesContainer.style.display = "grid";
        choices.forEach((c, i) => {
            const btn = document.getElementById("choice" + (i + 1));
            if (c && c.trim() !== "") {
                btn.style.display = "inline-block";
                btn.textContent = c;
            } else {
                btn.style.display = "none";
            }
        });
    }

    // âœ… ì •ë‹µ í™•ì¸ ë²„íŠ¼ ë³´ì´ê¸°
    const showAnswerBtn = document.getElementById("showAnswerBtn");
showAnswerBtn.style.display = "inline-block";
showAnswerBtn.onclick = () => {
    const fullscreenAnswer = document.getElementById("fullscreenAnswer");
    fullscreenAnswer.textContent = currentQuestion.answer || "ì •ë‹µ ì—†ìŒ";
    fullscreenAnswer.style.display = "flex"; // í™”ë©´ ì „ì²´ì— í‘œì‹œ

    // 2ì´ˆ í›„ ìë™ ìˆ¨ê¹€
    setTimeout(() => {
        fullscreenAnswer.style.display = "none";
    }, 2000);
};

    document.getElementById("questionPopup").style.display = "block";
}

// ì •ë‹µ / ì˜¤ë‹µ ë²„íŠ¼
// ì •ë‹µ/ì˜¤ë‹µ ë²„íŠ¼ í´ë¦­ ì²˜ë¦¬
function handleAnswer(isCorrect) {
  const fullscreenAnswer = document.getElementById("fullscreenAnswer");

  if (isCorrect) {
    fullscreenAnswer.innerText = "ì •ë‹µ!";
    fullscreenAnswer.style.display = "flex"; // ì¤‘ì•™ ì •ë ¬ ìœ„í•´ flex

    // ì ìˆ˜ ì¶”ê°€ (ë‚œì´ë„ì— ë”°ë¼ ì ìˆ˜ ê³„ì‚°)
    let scoreToAdd = 0;
    if (selectedDifficulty === "í•˜") scoreToAdd = 1;
    if (selectedDifficulty === "ì¤‘") scoreToAdd = 2;
    if (selectedDifficulty === "ìƒ") scoreToAdd = 3;

        // ì ìˆ˜ ì €ì¥
    playerscores[players[currentPlayer]] += scoreToAdd;

    // ë„ì‹œ ìƒ‰ì¹  (í•˜/ì¤‘ ë¬¸ì œ)
    document.querySelectorAll(".cell").forEach(cell => {
      if (cell.textContent.trim() === selectedCity) {
        cell.style.backgroundColor = playerColors[currentPlayer];
        cell.style.color = "white";
        cell.style.fontWeight = "bold";
      }
    });
    // ì ìˆ˜íŒ ê°±ì‹ 
    updateScoreTable();
  } else {
    fullscreenAnswer.innerText = "ì˜¤ë‹µ!";
  }

  // ì •ë‹µ/ì˜¤ë‹µ í™”ë©´ í‘œì‹œ
  fullscreenAnswer.style.display = "flex";

    setTimeout(() => {
    fullscreenAnswer.style.display = "none";
    document.getElementById("questionPopup").style.display = "none";

    // í„´ ë„˜ê¸°ê¸°
    currentPlayer = (currentPlayer + 1) % players.length;
    updateTurnDisplay();
  }, 1500);
}

 function answerQuestion(correct) {
  document.getElementById("questionPopup").style.display = "none";

  if (correct) {
    const correctSound = document.getElementById("correctSound");
    correctSound.play().catch(()=>{});

    let points = 0;
    if (selectedDifficulty === "í•˜") points = 1;
    else if (selectedDifficulty === "ì¤‘") points = 2;
    else if (selectedDifficulty === "ìƒ") points = 3;

    playerscores[currentPlayer] += points;

    // í•´ë‹¹ ë„ì‹œ ìƒ‰ì¹ 
    document.querySelectorAll(".cell").forEach(cell => {
      if (cell.textContent.trim() === selectedCity) {
        cell.style.backgroundColor = playerColors[currentPlayer];
        cell.style.color = "white";
        cell.style.fontWeight = "bold";
      }
    });

    updateScoreTable();
  } else {
    const wrongSound = document.getElementById("wrongSound");
    wrongSound.play().catch(()=>{});
  }

  // í„´ ë„˜ê¸°ê¸°
  currentPlayer = (currentPlayer + 1) % players.length;
  updateTurnDisplay();
}

    const playerscores = {};

  // ===== ë‚œì´ë„ ì„ íƒ í›„ ë¬¸ì œ ë³´ì—¬ì£¼ê¸° =====

    function startGame() {
   document.getElementById("startScreen").style.display = "none"; 

   const inputs = document.querySelectorAll(".playerName");
  players.length = 0; 
  inputs.forEach(input => {
    const name = input.value.trim();
    if (name) players.push(name);
  });

  if (players.length < 1) {
    alert("ìµœì†Œ 1ëª…ì˜ í”Œë ˆì´ì–´ê°€ í•„ìš”í•©ë‹ˆë‹¤!");
    return;
  }

// playerscores ì´ˆê¸°í™”
      for (const key in playerscores) delete playerscores[key];
      players.forEach(p => {
        playerscores[p] = 0;
        currentPlayer = 0;
      });

  // ê²Œì„ í™”ë©´ í‘œì‹œ
  document.getElementById("gameContainer").style.display = "flex";
  document.getElementById("scorePanel").classList.add("show"); // ì ìˆ˜íŒ ë³´ì´ê¸°

  drawBoard();
  updateTurnDisplay();
  updateScoreTable();

  // ë°°ê²½ ë³€ê²½
  document.body.style.backgroundImage = "none";
  document.body.style.backgroundColor = "black";

      // íš¨ê³¼ìŒ ì¬ìƒ
const startSound = document.getElementById("startSound");
startSound.play().catch(err => {
  console.log("ì‹œì‘ íš¨ê³¼ìŒ ì¬ìƒ ì‹¤íŒ¨:", err);
});
    }

function showSpecialEvent(city) {
    selectedCity = city;
    selectedDifficulty = "í•˜"; // ì ìˆ˜ë¥¼ ìœ„í•´ ë‚œì´ë„ëŠ” í•˜ë¡œ ê³ ì •

    resetQuestionUI(); // ğŸ”¥ ì¶”ê°€: ì´ì „ ì¼ë°˜ ë¬¸ì œ UI ì´ˆê¸°í™”

    // íŠ¹ìˆ˜ í…ìŠ¤íŠ¸ í‘œì‹œ
    const specialTextEl = document.getElementById("specialText");
    specialTextEl.textContent = specialCities[city];
    specialTextEl.style.display = "block";

    document.getElementById("questionPopup").style.display = "block";

    // ğŸµ íŠ¹ìˆ˜ íš¨ê³¼ìŒ ì¬ìƒ
    const specialSound = document.getElementById("specialSound");
    specialSound.play().catch(err => console.log(err));
}

function answerMultipleChoice(choiceIndex) {
  const selectedBtn = document.getElementById(`choice${choiceIndex+1}`);
  const selectedText = selectedBtn.textContent;

  const correct = selectedText === currentQuestion.answer;

  answerQuestion(correct); // ê¸°ì¡´ answerQuestion ì¬ì‚¬ìš©  
}

function cleanQuestionText(text) {
    if (!text) return "";

    // 1. ìœˆë„ìš° ì¤„ë°”ê¿ˆ í†µì¼
    text = text.replace(/\r\n/g, "\n").replace(/\r/g, "\n");

    // 2. ì—°ì†ëœ ë¹ˆ ì¤„ ì œê±° (3ì¤„ ì´ìƒ â†’ 1ì¤„ë§Œ ë‚¨ê¹€)
    text = text.replace(/\n{2,}/g, "\n");

    // 3. ê° ì¤„ ì•ë’¤ ê³µë°± ì œê±°
    text = text.split("\n").map(line => line.trim()).join("\n");

    // 4. ë§¨ ì•ë’¤ ê³µë°± ì œê±°
    text = text.trim();

    return text;
}

function drawBoard() {
      const grid = document.getElementById("grid");
      grid.innerHTML = "";
      cities.forEach((city, idx) => {
        const cell = document.createElement("div");
        cell.className = "cell";
        cell.textContent = city;
        cell.onclick = () => {
          if (specialCities[city]) {
            showSpecialEvent(city);
          } else {
            openDifficultyPopup(city);
          }
        };
        const startIndex = startPositions.indexOf(city);
        if (startIndex !== -1 && startIndex < players.length) {
          cell.style.backgroundColor = playerColors[startIndex];
          cell.style.color = "white";
          cell.style.fontWeight = "bold";
        }
        grid.appendChild(cell);
      });
    }

  function updateScoreTable() {
  const headerRow = document.getElementById("scoreHeaderRow");
  const dataRow = document.getElementById("scoreDataRow");

  headerRow.innerHTML = "<th>ì¡°ëª…</th>";
  dataRow.innerHTML = "<th>ì ìˆ˜</th>";

  players.forEach((player, idx) => {
    headerRow.innerHTML += `<th><span class="colorBox" style="background-color:${playerColors[idx]}"></span>${player}</th>`;
    dataRow.innerHTML += `<td>${playerscores[player]}</td>`;
  });
}

    function updateTurnDisplay() {
      if (players.length > 0) {
        document.getElementById("turnDisplay").textContent = `${players[currentPlayer]}`;
        document.getElementById("turnDisplay").style.color = playerColors[currentPlayer];
      }
    }
    function endGame() {
  // ğŸ’¥ í­ë°œ íš¨ê³¼ ì‹¤í–‰
  const explosion = document.getElementById("explosionEffect");
  explosion.style.display = "block";
  explosion.style.animation = "explode 1s ease-out";

  // 1ì´ˆ í›„ ì œê±°
  setTimeout(() => {
    explosion.style.display = "none";
  }, 1000);

  // ìˆœìœ„ ê³„ì‚°
  let ranking = [...players];
  ranking.sort((a, b) => playerscores[b] - playerscores[a]);

  let rankingText = "";
  ranking.forEach((player, i) => {
    let fontSize = 36 - i * 4; // 1ë“±: 36px â†’ 2ë“±: 32px ...
    if (fontSize < 16) fontSize = 16;

    let style = `
      font-size: ${fontSize}px;
      font-weight: ${i === 0 ? 'bold' : 'normal'};
      color: ${i === 0 ? '#d9534f' : '#222'};
      margin-bottom: 10px;
      text-align: center;
    `;
    rankingText += `<div style="${style}">${i + 1}ìœ„ ${player} - ì ìˆ˜: ${playerscores[player]}</div>`;
  });

  document.getElementById("rankingList").innerHTML = rankingText;
  document.getElementById("rankingPopup").style.display = "block";
}
   
    function closeRankingPopup() {
      document.getElementById("rankingPopup").style.display = "none";
    }

      // âœ… ìŒì•… ì¬ìƒ
  const bgm = document.getElementById("bgm");
  bgm.volume = 0.3;     // ë³¼ë¥¨ ì¡°ì ˆ (0 ~ 1)
  bgm.loop = true;      // ë°˜ë³µ ì¬ìƒ
  bgm.play().catch(err => {
    console.log("ìŒì•… ìë™ ì¬ìƒì´ ì°¨ë‹¨ë¨:", err);
  });

    // ì¡° ì´ë¦„ ì…ë ¥ ì™„ë£Œ í›„ ì—”í„° ëˆŒëŸ¬ë„ ê²Œì„ ì‹œì‘ ê°€ëŠ¥
    document.querySelectorAll(".playerName").forEach(input => {
  input.addEventListener("keypress", e => {
    if (e.key === "Enter") {
      startGame();
    }
  });
});

    // ì…ë ¥ì¹¸ 6ê°œ ì¤‘ í•˜ë‚˜ë¼ë„ ë³€ê²½ë˜ë©´ í”Œë ˆì´ì–´ ì´ë¦„ ìë™ ì—…ë°ì´íŠ¸
    document.querySelectorAll(".playerName").forEach(input => {
      input.addEventListener("input", () => {
        // ìë™ìœ¼ë¡œ í”Œë ˆì´ì–´ ì´ë¦„ ê°±ì‹ 
        // (ì¶”ê°€ êµ¬í˜„ ê°€ëŠ¥)
      });
    });

    window.addEventListener("DOMContentLoaded", () => {
  const fullscreenAnswer = document.getElementById("fullscreenAnswer");
  const closeBtn = document.getElementById("questionPopupClose");
    closeBtn.addEventListener("click", () => {
        document.getElementById("questionPopup").style.display = "none";
        resetQuestionUI();
    });
  // ì´ì œ JS ì½”ë“œ ì•ˆì „í•˜ê²Œ ì‚¬ìš© ê°€ëŠ¥
});
  </script>
  <div id="explosionEffect" style="display: none;">ğŸ’¥</div>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</body>
</html>
